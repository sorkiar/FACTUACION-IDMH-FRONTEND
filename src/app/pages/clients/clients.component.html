<div>
  <app-page-breadcrumb pageTitle="Mantenimiento de Clientes" />
  <div
    class="rounded-2xl border border-gray-200 bg-white px-3 py-5 dark:border-gray-800 dark:bg-white/[0.03] xl:px-4 xl:py-5 mb-3 flex justify-between"
  >
    <div></div>
    <div>
      <button
        type="button"
        class="bg-indigo-300 hover:bg-indigo-400 inline-flex items-center mr-1 px-3 py-1 text-sm font-medium rounded-sm"
        (click)="onCreateClient()"
      >
        <svg
          width="14"
          height="14"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M12.0002 4.875C12.6216 4.875 13.1252 5.37868 13.1252 6V10.8752H18.0007C18.622 10.8752 19.1257 11.3789 19.1257 12.0002C19.1257 12.6216 18.622 13.1252 18.0007 13.1252H13.1252V18.0007C13.1252 18.622 12.6216 19.1257 12.0002 19.1257C11.3789 19.1257 10.8752 18.622 10.8752 18.0007V13.1252H6C5.37868 13.1252 4.875 12.6216 4.875 12.0002C4.875 11.3789 5.37868 10.8752 6 10.8752H10.8752V6C10.8752 5.37868 11.3789 4.875 12.0002 4.875Z"
            fill="#323544"
          />
        </svg>
        <p class="text-sm font-semibold text-gray-800 ml-2">Agregar</p>
      </button>
    </div>
  </div>
  <div
    class="min-h-screen rounded-2xl border border-gray-200 bg-white px-3 py-5 dark:border-gray-800 dark:bg-white/[0.03] xl:px-4 xl:py-5"
  >
    <div class="w-full">
      <div
        class="rounded-2xl border border-gray-200 bg-white pt-4 dark:border-white/[0.05] dark:bg-white/[0.03]"
      >
        <div
          class="flex flex-col gap-2 px-5 mb-4 sm:flex-row sm:items-center sm:justify-between sm:px-6"
        >
          <div>
            <h3 class="text-lg font-semibold text-gray-800 dark:text-white/90">
              Listado de clientes
            </h3>
          </div>
          <div class="flex flex-col gap-3 sm:flex-row sm:items-center">
            <form>
              <div class="relative">
                <button
                  class="absolute -translate-y-1/2 left-4 top-1/2"
                  type="button"
                >
                  <svg
                    class="fill-gray-500 dark:fill-gray-400"
                    width="20"
                    height="20"
                    viewBox="0 0 20 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      fill-rule="evenodd"
                      clip-rule="evenodd"
                      d="M3.04199 9.37381C3.04199 5.87712 5.87735 3.04218 9.37533 3.04218C12.8733 3.04218 15.7087 5.87712 15.7087 9.37381C15.7087 12.8705 12.8733 15.7055 9.37533 15.7055C5.87735 15.7055 3.04199 12.8705 3.04199 9.37381ZM9.37533 1.54218C5.04926 1.54218 1.54199 5.04835 1.54199 9.37381C1.54199 13.6993 5.04926 17.2055 9.37533 17.2055C11.2676 17.2055 13.0032 16.5346 14.3572 15.4178L17.1773 18.2381C17.4702 18.531 17.945 18.5311 18.2379 18.2382C18.5308 17.9453 18.5309 17.4704 18.238 17.1775L15.4182 14.3575C16.5367 13.0035 17.2087 11.2671 17.2087 9.37381C17.2087 5.04835 13.7014 1.54218 9.37533 1.54218Z"
                      fill=""
                    ></path>
                  </svg>
                </button>
                <input
                  type="text"
                  placeholder="Buscar..."
                  class="dark:bg-dark-900 h-[42px] w-full rounded-lg border border-gray-300 bg-transparent py-2.5 pl-[42px] pr-4 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800 xl:w-[300px]"
                />
              </div>
            </form>
          </div>
        </div>

        <div class="overflow-hidden">
          <div class="max-w-full px-5 overflow-x-auto sm:px-6">
            <table class="min-w-full">
              <thead class="border-gray-100 border-y dark:border-white/[0.05]">
                <tr>
                  <th
                    class="py-3 font-normal text-gray-500 text-start text-theme-sm dark:text-gray-400"
                  >
                    Nombres
                  </th>
                  <th
                    class="py-3 font-normal text-gray-500 text-start text-theme-sm dark:text-gray-400"
                  >
                    Documento
                  </th>
                  <th
                    class="py-3 font-normal text-gray-500 text-start text-theme-sm dark:text-gray-400"
                  >
                    Tel√©fono
                  </th>
                  <th
                    class="py-3 font-normal text-gray-500 text-start text-theme-sm dark:text-gray-400"
                  >
                    Correo
                  </th>
                  <th
                    class="ppy-3 font-normal text-gray-500 text-start text-theme-sm dark:text-gray-400"
                  >
                    Estado
                  </th>
                  <th
                    class="py-3 font-normal text-gray-500 text-start text-theme-sm dark:text-gray-400"
                  >
                    Acciones
                  </th>
                </tr>
              </thead>
              <tbody class="divide-y divide-gray-100 dark:divide-white/[0.05]">
                @if (loading) {
                  <tr>
                    <td
                      class="py-4 text-center text-gray-700 text-theme-sm dark:text-gray-400"
                      colspan="6"
                    >
                      Cargando...
                    </td>
                  </tr>
                } @else {
                  @if (currentItems.length === 0) {
                    <tr>
                      <td
                        class="py-4 text-center text-gray-700 text-theme-sm dark:text-gray-400"
                        colspan="6"
                      >
                        No hay datos disponibles.
                      </td>
                    </tr>
                  } @else {
                    @for (item of currentItems; track $index) {
                      <tr>
                        <td class="py-2">
                          <div class="flex items-center gap-3">
                            <span
                              class="block font-medium text-gray-700 text-theme-sm dark:text-gray-400"
                            >
                              {{ item.firstName }} {{ item.lastName }}
                            </span>
                          </div>
                        </td>
                        <td
                          class="py-2 text-gray-700 whitespace-nowrap text-theme-sm dark:text-gray-400"
                        >
                          {{ item.documentNumber }}
                        </td>
                        <td
                          class="py-2 text-gray-700 text-theme-sm dark:text-gray-400"
                        >
                          {{ item.phone1 }}
                        </td>
                        <td
                          class="py-2 text-gray-700 text-theme-sm dark:text-gray-400"
                        >
                          {{ item.email1 }}
                        </td>
                        <td
                          class="py-2 text-gray-700 text-theme-sm dark:text-gray-400"
                        >
                          <app-badge
                            size="sm"
                            [color]="getBadgeColor(item.status)"
                          >
                            {{ getBadgeText(item.status) }}
                          </app-badge>
                        </td>
                        <td
                          class="py-2 text-gray-700 text-theme-sm dark:text-gray-400"
                        >
                          <div>
                            <div
                              class="shadow-theme-xs inline-flex items-center gap-1.5"
                            >
                              <button
                                type="button"
                                class="bg-orange-300 hover:bg-orange-400 inline-flex items-center gap-2 px-2.5 py-2 text-sm font-medium text-white rounded-md"
                                (click)="onEditClient(item)"
                              >
                                <svg
                                  width="18"
                                  height="18"
                                  viewBox="0 0 24 24"
                                  fill="none"
                                  xmlns="http://www.w3.org/2000/svg"
                                >
                                  <path
                                    fill-rule="evenodd"
                                    clip-rule="evenodd"
                                    d="M20.8749 2.51272C20.1915 1.8293 19.0835 1.8293 18.4001 2.51272L13.2418 7.67095C12.879 8.03379 12.6511 8.50974 12.5959 9.0199L12.4069 10.7668C12.3824 10.9926 12.4616 11.2173 12.6222 11.3778C12.7827 11.5384 13.0074 11.6176 13.2332 11.5931L14.9801 11.4041C15.4903 11.3489 15.9662 11.121 16.3291 10.7582L21.4873 5.59994C22.1707 4.91652 22.1707 3.80848 21.4873 3.12506L20.8749 2.51272ZM18.5981 4.43601L19.564 5.40191L15.2684 9.69751C15.1474 9.81846 14.9888 9.89443 14.8187 9.91283L13.9984 10.0016L14.0872 9.18126C14.1056 9.01121 14.1815 8.85256 14.3025 8.73161L18.5981 4.43601Z"
                                    fill="#323544"
                                  />
                                  <path
                                    d="M5.5 3.25H15.5411L14.0411 4.75H5.5C5.08579 4.75 4.75 5.08579 4.75 5.5V18.5C4.75 18.9142 5.08579 19.25 5.5 19.25H18.5C18.9142 19.25 19.25 18.9142 19.25 18.5V9.95823L20.75 8.45823V18.5C20.75 19.7426 19.7426 20.75 18.5 20.75H5.5C4.25736 20.75 3.25 19.7426 3.25 18.5V5.5C3.25 4.25736 4.25736 3.25 5.5 3.25Z"
                                    fill="#323544"
                                  />
                                </svg>
                              </button>
                              <button
                                type="button"
                                class="bg-red-300 hover:bg-red-400 inline-flex items-center gap-2 px-2.5 py-2 text-sm font-medium text-white rounded-md"
                                (click)="onToggleStatus(item)"
                              >
                                <svg
                                  width="18"
                                  height="18"
                                  viewBox="0 0 24 24"
                                  fill="none"
                                  xmlns="http://www.w3.org/2000/svg"
                                >
                                  <path
                                    d="M14.7223 12.7585C14.7426 12.3448 14.4237 11.9929 14.01 11.9726C13.5963 11.9522 13.2444 12.2711 13.2241 12.6848L12.9999 17.2415C12.9796 17.6552 13.2985 18.0071 13.7122 18.0274C14.1259 18.0478 14.4778 17.7289 14.4981 17.3152L14.7223 12.7585Z"
                                    fill="#323544"
                                  />
                                  <path
                                    d="M9.98802 11.9726C9.5743 11.9929 9.25542 12.3448 9.27577 12.7585L9.49993 17.3152C9.52028 17.7289 9.87216 18.0478 10.2859 18.0274C10.6996 18.0071 11.0185 17.6552 10.9981 17.2415L10.774 12.6848C10.7536 12.2711 10.4017 11.9522 9.98802 11.9726Z"
                                    fill="#323544"
                                  />
                                  <path
                                    fill-rule="evenodd"
                                    clip-rule="evenodd"
                                    d="M10.249 2C9.00638 2 7.99902 3.00736 7.99902 4.25V5H5.5C4.25736 5 3.25 6.00736 3.25 7.25C3.25 8.28958 3.95503 9.16449 4.91303 9.42267L5.54076 19.8848C5.61205 21.0729 6.59642 22 7.78672 22H16.2113C17.4016 22 18.386 21.0729 18.4573 19.8848L19.085 9.42267C20.043 9.16449 20.748 8.28958 20.748 7.25C20.748 6.00736 19.7407 5 18.498 5H15.999V4.25C15.999 3.00736 14.9917 2 13.749 2H10.249ZM14.499 5V4.25C14.499 3.83579 14.1632 3.5 13.749 3.5H10.249C9.83481 3.5 9.49902 3.83579 9.49902 4.25V5H14.499ZM5.5 6.5C5.08579 6.5 4.75 6.83579 4.75 7.25C4.75 7.66421 5.08579 8 5.5 8H18.498C18.9123 8 19.248 7.66421 19.248 7.25C19.248 6.83579 18.9123 6.5 18.498 6.5H5.5ZM6.42037 9.5H17.5777L16.96 19.7949C16.9362 20.191 16.6081 20.5 16.2113 20.5H7.78672C7.38995 20.5 7.06183 20.191 7.03807 19.7949L6.42037 9.5Z"
                                    fill="#323544"
                                  />
                                </svg>
                              </button>
                            </div>
                          </div>
                        </td>
                      </tr>
                    }
                  }
                }
              </tbody>
            </table>
          </div>
        </div>

        <!-- Pagination Controls -->
        <div
          class="px-6 py-4 border-t border-gray-200 dark:border-white/[0.05]"
        >
          <div class="flex items-center justify-between">
            <!-- Previous Button -->
            <app-button
              size="sm"
              variant="outline"
              (btnClick)="goToPage(currentPage - 1)"
              [disabled]="currentPage === 1"
            >
              <svg
                class="fill-current"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M2.58301 9.99868C2.58272 10.1909 2.65588 10.3833 2.80249 10.53L7.79915 15.5301C8.09194 15.8231 8.56682 15.8233 8.85981 15.5305C9.15281 15.2377 9.15297 14.7629 8.86018 14.4699L5.14009 10.7472L16.6675 10.7472C17.0817 10.7472 17.4175 10.4114 17.4175 9.99715C17.4175 9.58294 17.0817 9.24715 16.6675 9.24715L5.14554 9.24715L8.86017 5.53016C9.15297 5.23717 9.15282 4.7623 8.85983 4.4695C8.56684 4.1767 8.09197 4.17685 7.79917 4.46984L2.84167 9.43049C2.68321 9.568 2.58301 9.77087 2.58301 9.99715C2.58301 9.99766 2.58301 9.99817 2.58301 9.99868Z"
                  fill=""
                ></path>
              </svg>
              <span class="hidden sm:inline">Anterior</span>
            </app-button>
            <!-- Page Info -->
            <span
              class="block text-sm font-medium text-gray-700 dark:text-gray-400 sm:hidden"
            >
              Page {{ currentPage }} of {{ totalPages }}
            </span>
            <!-- Page Numbers -->
            <ul class="hidden items-center gap-0.5 sm:flex">
              @for (
                page of [].constructor(totalPages);
                track $index;
                let idx = $index
              ) {
                <li>
                  <button
                    (click)="goToPage(idx + 1)"
                    class="flex h-10 w-10 items-center justify-center rounded-lg text-theme-sm font-medium"
                    [ngClass]="{
                      'bg-brand-500 text-white': currentPage === idx + 1,
                      'text-gray-700 hover:bg-brand-500/[0.08] dark:hover:bg-brand-500 dark:hover:text-white hover:text-brand-500 dark:text-gray-400':
                        currentPage !== idx + 1,
                    }"
                  >
                    {{ idx + 1 }}
                  </button>
                </li>
              }
            </ul>
            <!-- Next Button -->
            <app-button
              (btnClick)="goToPage(currentPage + 1)"
              size="sm"
              variant="outline"
              [disabled]="currentPage === totalPages"
            >
              <span class="hidden sm:inline">Siguiente</span>
              <svg
                class="fill-current"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M17.4175 9.9986C17.4178 10.1909 17.3446 10.3832 17.198 10.53L12.2013 15.5301C11.9085 15.8231 11.4337 15.8233 11.1407 15.5305C10.8477 15.2377 10.8475 14.7629 11.1403 14.4699L14.8604 10.7472L3.33301 10.7472C2.91879 10.7472 2.58301 10.4114 2.58301 9.99715C2.58301 9.58294 2.91879 9.24715 3.33301 9.24715L14.8549 9.24715L11.1403 5.53016C10.8475 5.23717 10.8477 4.7623 11.1407 4.4695C11.4336 4.1767 11.9085 4.17685 12.2013 4.46984L17.1588 9.43049C17.3173 9.568 17.4175 9.77087 17.4175 9.99715C17.4175 9.99763 17.4175 9.99812 17.4175 9.9986Z"
                  fill=""
                ></path>
              </svg>
            </app-button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

@if (showForm) {
  <app-client-form
    [client]="selectedClient"
    [isEdit]="isEditMode"
    (saved)="loadClients(); onCloseForm()"
    (closed)="onCloseForm()"
  />
}